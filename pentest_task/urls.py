from django.urls import path
from . import views
from django.conf import settings
from django.conf.urls.static import static

app_name = 'pentest_task'

urlpatterns = [
    path('create/<int:appsec_task_id>/', views.create_pentest_task, name='create_pentest_task'),
    path('list/', views.list_pentest_tasks, name='list_pentest_tasks'),
    path('view/<int:task_id>/', views.view_pentest_task, name='view_pentest_task'),
    path("edit/<int:task_id>/", views.edit_pentest_task, name="edit_pentest_task"),
    path("delete/<int:task_id>/", views.delete_pentest_task, name="delete_pentest_task"),
    path("retest/<int:task_id>/", views.create_retest_task, name="create_retest_task"),
    path("retest_tasks/", views.list_retest_tasks, name="list_retest_tasks"),

    path('<int:pentest_task_id>/vulnerabilities/', views.list_vulnerabilities, name="list_vulnerabilities"),
    path('<int:pentest_task_id>/vulnerabilities/add/', views.add_vulnerability, name="add_vulnerability"),
    path('<int:pentest_task_id>/vulnerabilities/<int:vulnerability_id>/view/', views.view_vulnerability, name='view_vulnerability'),
    path('<int:pentest_task_id>/vulnerabilities/<int:vulnerability_id>/edit/', views.edit_vulnerability, name='edit_vulnerability'),
    path('<int:pentest_task_id>/vulnerabilities/<int:vulnerability_id>/delete/', views.delete_vulnerability, name='delete_vulnerability'),
   
    path("<int:pentest_task_id>/export_report/", views.export_pentest_report, name="export_pentest_report"),
    path("<int:pentest_task_id>/export_vuln_details/", views.export_details_vulnerability_excel, name="export_details_vulnerability_excel"),
    
    path('import/all_vulnerabilities/', views.import_vulnerabilities, name='import_vulnerabilities'),
    #martor
    path("martor/uploader/", views.martor_upload_image, name="martor_upload"), 

    # template cho vulnerability
    path('save_to_template/<int:vuln_id>/', views.save_to_template, name="save_to_template"),
    path('get_vuln_template_suggestions/', views.get_vuln_template_suggestions, name='get_vuln_template_suggestions'),
    
    path('vuln-templates/', views.list_vuln_templates, name='list_vuln_templates'),
    path('vuln-templates/view/<int:vuln_template_id>/', views.view_vuln_template, name='view_vuln_template'),
    path('vuln-templates/create/', views.vuln_template_create, name='vuln_template_create'),
    path('vuln-templates/edit/<int:pk>/', views.vuln_template_edit, name='vuln_template_edit'),
    path('vuln-templates/delete/<int:pk>/', views.vuln_template_delete, name='vuln_template_delete'),

    path('my-tasks/', views.my_task_view, name='my_task_view'),
       
]
if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)